import streamlit as st
import requests
from PIL import Image
from io import BytesIO

# Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
st.title("ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø£ÙÙ„Ø§Ù… Ø§Ù„Ø¬Ù†Ø³ÙŠØ© Ø§Ù„ØµØ±ÙŠØ­Ø©")

# Ù†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø§Ù„ØªÙˆØµÙŠØ§Øª
st.header("Ø§Ø·Ù„Ø¨ ØªÙˆØµÙŠØ§ØªÙƒ")

# Ø­Ù‚ÙˆÙ„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
genre = st.text_input("Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ù…ÙØ¶Ù„:")
themes = st.text_input("Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ù…ÙØ¶Ù„Ø©:")
elements = st.text_input("Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ÙØ¶Ù„Ø©:")

# Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
if st.button("Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªÙˆØµÙŠØ§Øª"):
    # Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§ØŒ Ù†Ø­Ù† Ù†ÙØªØ±Ø¶ ÙˆØ¬ÙˆØ¯ API ÙŠØ¹ÙˆØ¯ Ø¨Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
    # Ø³Ù†Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§ Ù…Ø«Ø§Ù„Ø§Ù‹ ØªØ®ÙŠÙ„ÙŠØ§Ù‹
    url = "https://example.com/api/movies"
    params = {
        "genre": genre,
        "themes": themes,
        "elements": elements
    }
    
    response = requests.get(url, params=params)
    
    if response.status_code == 200:
        movies = response.json()
        
        for movie in movies:
            st.subheader(movie["name"])
            st.text(f"Ø³Ù†Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬: {movie['year']}")
            st.text(f"Ø§Ù„Ù†ÙˆØ¹: {movie['type']}")
            st.text(f"Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ¹Ø±ÙŠ: {movie['nudity_percentage']}% ğŸ”¥" if movie['nudity_percentage'] >= 95 else f"Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ¹Ø±ÙŠ: {movie['nudity_percentage']}%")
            st.text(f"Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø±ÙŠ: {'ÙƒØ§Ù…Ù„ ğŸ”' if movie['full_nudity'] else 'Ù†ØµÙÙŠ'}")
            st.text(f"Ù‡Ù„ ÙŠØ¸Ù‡Ø± Ø§Ù„Ù…Ù‡Ø¨Ù„ ÙˆØ§Ù„Ù‚Ø¶ÙŠØ¨: {'Ù†Ø¹Ù… ğŸ¥µ' if movie['genitals_visible'] else 'Ù„Ø§'}")
            st.text(f"Ù‡Ù„ Ø§Ù„Ù‚Ø¶ÙŠØ¨ ÙŠØ¯Ø®Ù„ ÙÙŠ Ø§Ù„Ù…Ù‡Ø¨Ù„: {'Ù†Ø¹Ù…' if movie['penetration'] else 'Ù„Ø§'}")
            st.text(f"Ù†ÙˆØ¹ Ø§Ù„Ù„Ù‚Ø·Ø©: {movie['scene_type']} ğŸŒ¶" if movie['scene_type'] == 'Ø¬Ø±Ø¦ÙŠØ© Ø¬Ø¯Ø§Ù‹' else movie['scene_type'])
            st.text(f"Ù„Ù‚Ø·Ø§Øª Ù…Ø­Ø¸ÙˆØ±Ø©: {'Ù†Ø¹Ù… ğŸš«' if movie['banned_scenes'] else 'Ù„Ø§'}")
            st.text(f"Ù‡Ù„ Ø§Ù„Ù„Ù‚Ø·Ø© Ø§Ù„ØªÙŠ Ø¨Ø­Ø«Øª Ø¹Ù†Ù‡Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø©: {'Ù†Ø¹Ù… ğŸ«¦' if movie['desired_scene_present'] else 'Ù„Ø§'}")
            st.text(f"ÙˆØµÙ Ù…Ø®ØªØµØ±: {movie['description']}")
            st.text(f"Ø§Ù„Ø¯ÙˆÙ„Ø©: {movie['country']}")
            
            # Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©
            image_url = movie["image_url"]
            response = requests.get(image_url)
            img = Image.open(BytesIO(response.content))
            st.image(img, caption=movie["name"])
    else:
        st.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªÙˆØµÙŠØ§Øª. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹.")
